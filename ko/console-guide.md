# Compute > System Monitoring > 콘솔 사용 가이드
콘솔 사용 가이드에서는 System Monitoring을 사용하는데 필요한 기본적인 내용을 설명합니다.
- 서버 대시보드
- 사용자 그룹
- 알림 그룹 

## 서버 대시보드
`Compute > System Monitoring > 서버 대시보드`에서는 모니터링 대상 인스턴스 목록과 기본 지표 차트를 확인할 수 있습니다.
만약 모니터링 가능한 서버가 존재하지 않는 경우 서버 목록은 비어있을 것입니다. 
이런 경우, `Compute > Instance`에서 사용 중인 인스턴스가 정상적으로 동작하고 있는지, 또는 모니터링 대상 인스턴스에 System Monitoring Agent가 설치되고 정상적으로 동작하고 있는지 확인이 필요합니다(**Agent 설치 방법** 참고).

모니터링 대상 서버 인스턴스에 Agent가 정상적으로 설치되어 System Monitoring에서 지표 데이터 수집이 진행되고 있다면 좌측의 서버 목록에 해당 인스턴스가 표시되고 이를 선택하면 우측의 차트를 통해서 수집된 지표 데이터를 확인할 수 있습니다.

### 서버 목록
서버 목록에서 원하는 서버를 선택하여 각 서버의 지표를 확인할 수 있습니다.
서버 목록에는 서버의 호스트명, IP 그리고 모니터링 상태를 나타내는 상태 표시등이 노출됩니다.
상태 표시등은 현재 모니터링 상태에 따라서 다음과 같은 색을 띄게 됩니다.

- 녹색: 정상
- 노란색: 인스턴스 정보를 알 수 없으나, 모니터링은 진행되고 있는 상태
- 붉은색: 가동 중인 인스턴스임에도 모니터링이 중단 된 상태
- 진한 회색: 작동이 중단 된 인스턴스
- 연한 회색: 삭제 된 인스턴스

인스턴스와 Agent의 상태값은 상태 표시등에 마우스 포인터를 올릴 때 나타나는 툴팁을 통해서 확인할 수 있습니다.

`Compute > Intsance`에서 삭제된 서버 인스턴스는 기본적으로 서버 대시보드의 서버 목록에는 노출되지 않습니다. 하지만 지표 데이터는 삭제하지 않고 보관하고 있습니다. 삭제된 인스턴스의 지표 조회를 원한다면 **삭제된 서버도 보기** 체크박스를 선택하여 확인 할 수 있습니다.

### 기본 레이아웃
처음 `Compute > System Monitoring > 서버 대시보드`에 접근시 보이는 차트 배열은 **기본 레이아웃**입니다. 별도 설정없이 기본적으로 이용할 수 있는 레이아웃입니다. 기본적으로 **CPU Used**, **Memory Used(excepted cache/buffer)**, **Disk**, **Network(In/Out bps)**에 대한 차트를 보여줍니다.
기본 레이아웃은 System Monitoring에서 기본적으로 제공하는 레이아웃이기 때문에 사용자가 직접 차트를 구성 할 수는 없습니다.

### 레이아웃 생성
새로운 지표를 추가하거나, 차트를 원하는대로 배치하기 위해서는 새로운 레이아웃이 필요합니다. 레이아웃은 서버 대시보드 상단의 **레이아웃 만들기 버튼**을 클릭하여 생성할 수 있습니다. 레이아웃은 프로젝트당 최대 5개까지 생성할 수 있습니다.

레이아웃 만들기 창에서 이름을 입력한 후 생성 버튼을 클릭하면 새로운 레이아웃이 생성됩니다. 새로운 레이아웃은 등록된 차트가 없기 때문에 빈 화면이 나타납니다. 새로운 차트를 추가하기 위해서는 화면에서 안내하는대로 차트 추가 버튼을 클릭하면 됩니다.

### 차트 생성
**차트 추가** 버튼을 클릭하면 선택 가능한 지표의 목록이 나타납니다.

우측에는 현재 System Monitoring에서 제공하는 지표 목록이 표시되며, 이들 중 하나를 선택하면 좌측에 차트 미리보기가 표시됩니다. 추가 버튼을 클릭하면 선택한 차트가 레이아웃 하단에 추가되는 것을 확인할 수 있습니다.

직접 생성한 레이아웃은 사용자가 원하는대로 차트의 위치와 크기를 조절할 수 있습니다. 사용자가 추가한 차트에는 아래와 같은 추가적인 기능이 제공됩니다.

- 우측 상단 아이콘 클릭: 레이아웃에서 차트를 삭제합니다.
- 우측 하단 아이콘 드래그: 차트의 크기를 조절할 수 있습니다.
- 차트 제목 드래그: 차트의 위치를 변경할 수 있습니다.

생성한 레이아웃은 상단의 레이아웃 드롭다운 메뉴를 통해서 선택할 수 있습니다.

### 레이아웃 수정 / 삭제
**레이아웃 관리 버튼**을 클릭하면 특정 레이아웃의 이름을 변경하거나 필요없는 레이아웃을 삭제할 수 있습니다.

### 날짜 선택
수집된 지표 데이터는 최대 5년까지 보관됩니다. 우측 상단에 존재하는 달력 버튼을 클릭하여 조회하고싶은 기간 범위를 설정할 수 있습니다. 

날짜 검색 창에서는 조회 기간으로 지정할 **시작 일시(From)와 끝 일시(To)를 선택**해야합니다. 시작 일시와 끝 일시를 선택하는데에는 두 가지 방식이 있습니다. 
첫 번째는 직접 일시를 선택하는 방식입니다. 시작 일시, 끝 일시를 클릭하면 별도의 일시 선택 팝업이 나타납니다. 이를 통해서 직접 일시를 지정할 수 있습니다. 

두 번째 방법은 단축 버튼을 사용하는 방식입니다. 각 일시 버튼 아래에는 현재, 1시간, 1일 등의 별도의 버튼이 존재합니다. 해당 버튼을 클릭하여 대략적인 기간 범위를 지정할 수 있습니다. 단축 버튼을 통해서 기간이 올바르게 지정되었다면 그 아래에 어떤 날짜 범위의 데이터를 가져올지에 대해 간략한 안내문이 나타납니다. (예시 : **7일 이전**부터 **현재**까지의 데이터를 검색합니다.)

날짜 선택 창과는 별개로 또 다른 날짜 범위 선택 방법은 차트에서 직접 조회 기간을 선택할 수도 있습니다. 차트 내에서 보길 원하는 시기에 해당하는 부분을 가로로 드래그하면 영역이 선택되어 해당 영역 기간 내의 데이터를 확인할 수 있습니다. 이를 통해서 차트 내에서 특이한 모습을 보인 구간을 선택해서 집중적으로 살펴볼 수 있습니다.

## 사용자 그룹
`Compute > System Monitoring > 사용자 그룹`에서는 System Monitoring에서 모니터링하는 대상에서 특정 이벤트가 발생했을 때 알림을 받을 대상을 지정할 수 있습니다. 프로젝트를 맴버 중 알림을 받을 맴버를 선택할 수 있으며, 알림을 받을 사용자를 여러 그룹으로 묶어서 관리할 수 있습니다.

처음 사용자 그룹을 조회하여 아무런 사용자 그룹이 존재하지 않는 경우 빈 화면이 나타납니다. System Monitoring으로부터 알림을 받기 위해서는 화면에서 안내하는대로 사용자 그룹을 추가해야 합니다.

### 사용자 그룹 생성
사용자 그룹은 `Compute > System Monitoring > 사용자 그룹`에서 **그룹 만들기 버튼**을 클릭하여 생성할 수 있습니다.

그룹 만들기 창에서 이름을 입력한 후 **생성 버튼**을 클릭하면 사용자 그룹이 생성됩니다. 그리고 자동으로 다음 단계로 넘어가 프로젝트 멤버를 사용자 그룹에 추가할 수 있습니다.

사용자 그룹 편집 창의 하단에는 현재 프로젝트에 속한 사용자 목록이 표시됩니다. 사용자 목록의 각 항목 우측에 있는 추가 버튼을 클릭하여 해당 사용자 그룹에 추가할 수 있습니다. 추후 연동할 알림 그룹을 통해서 사용자 그룹에 속한 사용자에게 알림이 가도록 설정할 수 있습니다.

사용자 그룹 생성이 완료되면 `Compute > System Monitoring > 사용자 그룹`에서 사용자 그룹 목록을 조회할 수 있습니다.

### 사용자 그룹 수정
이미 생성되어있는 사용자 그룹을 수정하기 위해서는 사용자 목록 그룹에서 편집 버튼을 클릭하면 됩니다. 해당 버튼을 클릭하면 사용자 그룹 편집 창이 표시됩니다. 생성 단계와 동일한 방법으로 사용자 그룹의 멤버를 수정할 수 있습니다. 원한다면 사용자 그룹 이름 우측의 연필 아이콘을 클릭히여 사용자 그룹 이름을 수정할 수 있습니다.

## 알림 그룹
알림 그룹은 `Compute > System Monitoring > 알림 그룹`에서 관리됩니다. 알림 그룹은 크게 두 가지 역할을 수행합니다. 첫 번째는 각 시스템 지표에 임계치를 설정하는 역할입니다. System Monitoring에서는 시스템 지표에 임계치를 설정한 것을 **감시설정**이라고 부릅니다. 선택한 시스템 지표가 임계치에 도달하는 경우 지정한 사용자 그룹을 통해서 알림이 통보될 것입니다. 두 번째는 생성한 감시설정을 모니터링 대상 서버와 연동하고 통보 대상이 될 사용자 그룹을 연동하는 기능을 수행합니다. 실질적으로 알림 그룹은 서버 대시보드와 사용자 그룹은 연결해주는 역할이라고 생각할 수 있습니다.

처음 알림 그룹를 조회하여 아무런 알림 그룹이 존재하지 않는 경우 빈 화면이 나타납니다. 시스템 지표에 임계치를 설정하고 원하는 사용자 그룹으로 알림을 보내고 싶다면 화면에서 안내하는대로 알림 그룹을 추가해야 합니다.

### 알림 그룹 생성
그룹 만들기 버튼을 클릭하여 신규 알림 그룹을 생성할 수 있습니다.

그룹 만들기 창에서 그룹 이름을 입력하고 생성 버튼을 클릭하면 알림 그룹이 추가됩니다.

### 감시 설정 등록/수정/삭제
감시 설정을 등록하기 위해서 원하는 알림 그룹 항목의 버튼들 중 좌측에 있는 **감시 설정 추가 버튼**을 클릭합니다. 감시 설정이 등록되지 않았다면 아무런 내용도 표시되지 않을 것입니다. 신규 감시 설정을 추가하기 위해서 감시 설정 추가 버튼을 클릭하면, 새로운 감시 설정 입력란이 추가됩니다. 이 시점에는 감시 설정이 저장되지 않습니다. 원하는 시스템 지표에 임계치를 지정하고 **저장** 버튼을 클릭하면 최종적으로 감시설정이 저장됩니다. 만약 취소 버튼을 클릭한다면 해당 입력란은 제거됩니다. 

저장된 감시 설정은 우측의 연필 아이콘을 클릭하여 다시 수정할 수 있으며, 휴지통 아이콘을 클릭하면 삭제할 수 있습니다.

현재 감시 설정 가능한 시스템 지표의 항목은 다음과 같습니다.

| 항목 | 단위 | 비교 방식 | 추가적인 요구값 |
| --- | --- | --- | --- |
| 리부트 | 리부트 | - | - |
| CPU: Used | % | 이상/이하 | - |
| CPU: Idle | % | 이상/이하 | - |
| CPU: User | % | 이상/이하 | - |
| CPU: System | % | 이상/이하 | - |
| CPU: nice | % | 이상/이하 | - |
| CPU: irq | % | 이상/이하 | - |
| CPU: softirq | % | 이상/이하 | - |
| CPU: io wait | % | 이상/이하 | - |
| Load Average: 1 Min | - | 이상/이하 | - |
| Load Average: 5 Min | - | 이상/이하 | - |
| Load Average: 15 Min | - | 이상/이하 | - |
| Memory: Used | % | 이상/이하 | - |
| Memory: Used | MB | 이상/이하 | - |
| Memory: Free | MB | 이상/이하 | - |
| Memory: Buffers | MB | 이상/이하 | - |
| Memory: Cached | MB | 이상/이하 | - |
| Memory: pgpgin | KB/s | 이상/이하 | - |
| Memory: pgpgout | KB/s | 이상/이하 | - |
| Swap: Used | % | 이상/이하 | - |
| Swap: Total | MB | 이상/이하 | - |
| Swap: Used | MB | 이상/이하 | - |
| Disk: Read | Counts | 이상/이하 | - |
| Disk: Write | Counts | 이상/이하 | - |
| Disk: Read | Bytes | 이상/이하 | - |
| Disk: Write | Bytes | 이상/이하 | - |
| File System: Used | MB | 이상/이하 | `파티션명` |
| File System: Avail | MB | 이상/이하 | `파티션명` |
| File System: Used | % | 이상/이하 | `파티션명` |
| File System: i-node Used | % | 이상/이하 | `파티션명` |
| File System: Mount | - | 포함/불포함 | - | `파티션명` |
| Network: Recv | Bytes/s | 이상/이하 | `인터페이스명` |
| Network: Send | Bytes/s | 이상/이하 | `인터페이스명` |
| Network: Recv Packets | pps| 이상/이하 | `인터페이스명` |
| Network: Send Packets | pps | 이상/이하 | `인터페이스명` |
| Network: Recv Error | Counts | 이상/이하 | `인터페이스명` |
| Network: Send Error | Counts | 이상/이하 | `인터페이스명` |
| Network: Collision | Counts | 이상/이하 | `인터페이스명` |
| User: User Count | - | 이상/이하 | `인터페이스명` |
| Process: Total Count | - | 이상/이하 | - |
| Process: Down | - | - | - | `프로세스명` |
| Process: Count | - | 이상/이하 | `프로세스명` |
| Process: CPU | % | 이상/이하 | `프로세스명` |
| Process: Memory | % | 이상/이하 | `프로세스명` |
| Process: Memory | KB | 이상/이하 | `프로세스명` |
| Process: Thread Count| - | 이상/이하 | `프로세스명` |
| Process: Restart | - | - | `프로세스명` |
| File: Content | TEXT | 포함/불포함 | `File Path` |
| File: Size | KB | 이상/이하 | `File Path` |
| File: Modification | - | - | `File Path` |
| File: Non-Modification | - | - | `File Path` |
| File: Non-Exist| - | - | `File Path` |

각 감시 항목은 고유한 값 단위를 가지고 있고 항목에 따라서 임계치 외에 추가적인 값을 요구할 수도 있습니다.

#### 감시 설정 지속 시간
감시 설정의 지속 시간은 중요한 요소입니다. 지속 시간은 감시 대상이 지정한 임계치에 도달한 후 그 상태가 지속되는 시간을 조건으로 지정 할 때 사용됩니다. 예를 들어, CPU 사용률의 임계치가 90% 이상이고 지속시간이 5분이라면, 해당 알림 그룹과 연동된 서버의 CPU 사용률이 90% 이상인 상태가 5분 이상 지속되었을때 사용자 그룹에 정의된 사용자들에게 알림을 보냅니다. 즉, 만약 CPU 사용률이 90% 이상이 되었더라도, 5분 이내에 90% 미만으로 떨어진다면 알림은 발생하지 않게 됩니다.

### 감시 대상 및 통보 대상 설정
앞에서 정의한 감시설정을 적용할 모니터링 대상 서버와 감시 조건이 충족될 경우 알림을 받을 사용자 그룹을 연결 지을 수 있습니다. 감시설정 버튼의 우측에 존재하는 **서버 및 사용자 그룹 연동 버튼**을 클릭합니다.

상단에서는 해당 알림 그룹에 정의된 감시설정을 반영할 서버를 지정합니다. 하단에서는 감시 조건 충족 시 알림을 받을 사용자 그룹을 지정합니다. 선택을 해제하고자 한다면 서버 또는 사용자 그룹 이름 우측의 X 버튼을 클릭하거나 드롭다운 메뉴에서 재선택을 하여 선택을 해제할 수 있습니다.

이후 `Compute > System Monitoring > 알림 그룹`에서 설정한 알림 그룹 목록을 조회할 수 있습니다.

## Agent 설치 방법
### Linux
- **root 권한 필요**
- 아래의 설치 명령을 실행합니다.

```bash
curl -s http://static.toastoven.net/toastcloud/sdk_download/monitoring/toast-sysmon-installer.sh | sh
```

- 실행되는 프로세스: **toast-sysmon** (2개)

### Windows
- **Administrator 권한 필요**
- 아래의 경로를 통해서 설치 파일을 다운로드하고 실행합니다.
```
http://static.toastoven.net/toastcloud/sdk_download/monitoring/toast-sysmon.exe
```
- 실행되는 프로세스: **toastmon.exe**
