## Compute > System Monitoring > OpenMetrics Monitoring > 콘솔 사용 가이드
콘솔 사용 가이드에서는 OpenMetrics Monitoring을 사용하는 데 필요한 내용을 설명합니다.
**Compute > System Monitoring > OpenMetrics 대시보드**에서는 모니터링 작업 공간을 정의하고 수집 대상을 지정하여 Exporter 또는 그 형식을 따르는 임의의 지표를 수집할 수 있습니다.
수집된 지표는 서버 대시보드와 유사한 방식으로 레이아웃과 차트를 구성하여 확인할 수 있습니다.

## 작업 공간
OpenMetrics 모니터링 기능을 사용하기 위해 가장 먼저 수행해야 하는 것은 작업 공간을 만드는 것입니다. 모니터링 목적과 성격이 같은 것을 하나의 작업 공간으로 정의하고, 수집 대상과 지표의 시각화 방법을 관리할 수 있습니다.
따라서 최소한 한 개 이상의 작업 공간이 존재해야 OpenMetrics 모니터링을 사용할 수 있습니다.

### 작업 공간 생성
대시보드 화면 좌측에는 작업 공간 목록이 표시됩니다. 목록의 최상단에는 작업 공간 검색을 위해 제공되는 입력란과 작업 공간 추가 팝업을 표시하기 위한 버튼이 있습니다.

**추가** 버튼을 클릭하면 작업 공간 추가 팝업이 나타납니다.
작업 공간에는 이름과 설명, URL Path를 입력하여 생성할 수 있습니다.
이름에는 영문자, 숫자, `-`, `_`를 입력할 수 있습니다.
URL Path에는 지표를 제공하는 페이지 주소 중, 도메인과 포트 등을 제외한 Path만을 입력하여야 합니다.

* Path 입력 예시

접속 대상 | 입력값
-------- | -------
http://localhost:9100/metrics | `/metrics`
http://localhost:8080/actuator/prometheus | `/actuator/prometheus`

### 작업 공간 수정/삭제
대시보드의 좌측에 표시되는 작업 공간 목록에서 각 작업 공간 항목의 우측에 톱니바퀴 아이콘이 있습니다. 이 아이콘을 클릭하면 작업 공간 관리 팝업이 나타납니다.

설명과 URL Path를 변경할 수 있으며, 입력 후 **수정** 버튼을 클릭하여 변경할 수 있습니다.

만약 작업 공간을 더 이상 사용하지 않아 제거를 원한다면 **삭제** 버튼을 클릭하여 작업 공간을 없앨 수 있습니다.
작업 공간을 삭제할 경우 해당 공간에 생성된 수집 대상과 레이아웃, 차트 등은 모두 삭제됩니다. 단, 같은 이름의 작업 공간을 다시 만들면 기존에 수집된 지표 데이터는 조회할 수 있습니다.

## 수집 대상
작업 공간을 생성하였다면 각 공간에서 모니터링할 대상을 지정해야 합니다. 대시보드의 좌측에 있는 작업 공간 목록에서 사용할 공간 하나를 선택하면, 화면 상단에 **수집 대상 관리** 버튼이 표시됩니다.
이 버튼을 클릭하면 수집 대상을 추가/삭제할 수 있는 팝업 창이 표시됩니다.

### 수집 대상 추가
수집 대상 관리 팝업의 상단에는 모니터링 대상 추가에 필요한 입력란이 표시됩니다.

**서버** 입력란을 클릭하면 현재 System Monitoring의 Agent가 정상적으로 동작하는 인스턴스들이 표시되며, 하나 이상을 선택하여 수집할 대상을 지정할 수 있습니다.

**포트** 입력란에는 지표 정보를 제공하고 있는 Exporter 또는 웹 애플리케이션의 포트를 입력합니다.

서버와 포트 모두 입력이 되면 **추가** 버튼을 클릭하여 대상을 추가할 수 있습니다.
현재는 작업 공간 구분 없이 서버 당 최대 5개의 수집 대상만 등록이 가능합니다.

### 수집 대상 조회
수집 대상 관리 팝업의 하단에는 이 작업 공간 내에 등록된 수집 대상의 목록이 표시됩니다.
상태 값은 색으로 구분하여 표시하고 있습니다. 정상 수집을 제외한 나머지는 원 위에 마우스를 올리면 상세 설명이 툴팁으로 표시됩니다.
색상 | 의미
---- | ----
녹색 | 정상 수집 중
노란색 | HTTP 에러 응답(404 Not Found, 503 Service Unavailable 등)
붉은색 | 수집 불가능 상태(해당 포트가 LISTEN이 아니거나 타임아웃 등)
회색 | 수집 준비 중(수집 대상 등록 직후 또는 인스턴스가 중지 된 상태)

> 만약 시간이 지속되어도 회색에 머물러있는 상태가 유지된다면 Agent를 최신 버전으로 업데이트해 주시길 바랍니다.
([Agent 설치 방법](https://docs.toast.com/ko/Compute/System%20Monitoring/ko/console-guide/#agent))
업데이트 이후에도 여전히 변화가 없다면 고객센터로 문의하시길 바랍니다.

### 수집 대상 삭제
수집 대상 관리 팝업의 하단 목록 아래에는 **삭제** 버튼이 있습니다. 목록에서 삭제할 대상을 좌측 체크박스에 선택한 후 삭제 버튼을 클릭하면 해당 대상은 모니터링이 중단됩니다.

## 레이아웃
작업 공간을 만들고 수집 대상을 지정하면 Agent는 지표를 수집하고 System Monitoring 시스템에 데이터를 저장합니다. 저장된 데이터를 조회하기 위해서는 레이아웃에서 차트를 구성하여야 합니다. 레이아웃은 서버 대시보드에서 제공하고 있는 것과 유사한 기능을 가지고 있습니다.

### 레이아웃 생성
대시보드에 차트를 만들고 배치하여 모니터링 정보를 시각화하고 싶다면 레이아웃을 만들어 목적과 관점에 따라 구성할 수 있습니다.
레이아웃을 만들려면 대시보드 상단의 **레이아웃 만들기** 버튼을 클릭합니다. 레이아웃은 작업 공간 당 최대 5개까지 만들 수 있습니다.

**레이아웃 만들기** 창에서 이름을 입력한 후 **생성** 버튼을 클릭하면 새로운 레이아웃이 생성됩니다. 등록된 차트가 없기 때문에 빈 화면이 나타납니다. 새로운 차트를 추가하려면 화면 안내에 따라 **차트 추가** 버튼을 클릭합니다.

### 레이아웃 수정/삭제
대시보드 상단의 **관리** 버튼을 클릭하면 특정 레이아웃의 이름을 변경하거나 필요 없는 레이아웃을 삭제할 수 있습니다.

## 차트
OpenMetrics 모니터링의 대시보드에서는 시스템에서 제공하고 있는 차트를 선택하는 서버 대시보드의 방식과는 달리 사용자가 차트로 표현하고 싶은 지표와 조건을 직접 지정하여 만들 수 있습니다.

### 차트 생성
레이아웃에 새로운 차트를 생성하려면 대시보드 상단의 **차트 추가** 버튼을 클릭합니다.

**차트 추가** 창에서 차트 이름과 차트의 Y 축 속성을 정의하고, 지표 등록과 알림 설정을 할 수 있습니다. 지표와 알림을 설정하는 화면은 각각 탭으로 구분되어 있습니다.
Y 축은 좌측과 우측을 각각 활성화할 수 있습니다. 각 축마다 표시될 수치의 단위를 지정할 수 있습니다.
활성화된 Y 축은 지표 추가 시 차트에 표시되는 격자의 기준으로 선택하게 됩니다. 따라서 좌측과 우측 둘 중 하나는 반드시 활성화가 되어야 합니다.
지표는 여러 개를 추가할 수 있습니다. 단, 최소 한 개의 지표는 반드시 추가가 되어야 합니다. 알림은 필요시 선택적으로 입력할 수 있습니다.

#### 지표
지표 탭에서 **지표 추가** 버튼을 클릭하면 지표 추가를 위해 입력해야 할 내용이 표시됩니다.

**지표** 입력란을 클릭하면 해당 작업 공간에서 현재 수집 중인 지표의 목록이 표시됩니다. 이 목록 중 하나를 선택할 수 있습니다.

지표 입력란의 우측에는 활성화된 Y 축 위치의 목록이 표시됩니다. 목록의 값을 선택하면 그 위치에 있는 Y 축의 범위를 기준으로 지표가 차트에 그려집니다. 만약 해당 지표가 표시할 값이 Y 축의 표현 범위를 벗어난다면, 그 지표의 가장 큰 값이 기준이 되어 표현 범위를 재설정하게 됩니다.

선택한 지표가 레이블을 가지고 있는 경우 그것의 값을 비교하여 조건에 맞는 데이터만 조회할 수 있도록 **필터**를 설정할 수 있습니다. 해당 지표가 가지고 있는 레이블 중 하나를 선택하고 비교할 값을 입력합니다. 필터 조건은 여러 개의 레이블에 대해 지정할 수 있지만, 같은 레이블에 대해 중복으로 설정하는 것은 불가능합니다. 제공하고 있는 비교 방법은 다음과 같습니다.


연산자 | 의미 | 예시
-------- | ------- | -------
`=` | 일치함 | `mode = user`<br/>`mode` 레이블의 값이 `user`인 것만 표시
`!=` | 일치하지 않음 | `mode != idle`<br/>`mode` 레이블의 값이 `idle`이 아닌 것만 표시
`=~` | 정규 표현식에 부합함 | `code =~ 2.*`<br/>`code` 레이블의 값이 `2`로 시작하는 것만 표시
`!~` | 정규 표현식에 부합하지 않음 | `code !~ 5.*`<br/>`code` 레이블의 값이 `5`로 시작하지 않는 것만 표시

지표의 속성을 입력한 후 **등록** 버튼을 클릭하면 좌측 차트 미리 보기를 통해 의도한 대로 데이터가 그려지는지 확인할 수 있습니다.

#### 알림
알림 탭에서 **알림 추가** 버튼을 클릭하면 알림 설정을 위해 입력해야 할 내용이 표시됩니다.

알림 설정의 구분을 위하여 **이름**을 입력하고, 감시 대상의 **임계치**를 입력합니다. 설정한 임계치는 해당 차트의 지표로 추가한 항목들 전체에 일괄 적용됩니다. 
**지속시간**은 해당 조건이 몇 분 이상 유지될 경우 이벤트가 발생한 것으로 판단할지 설정하는 것입니다. 만약 이 값을 0으로 입력한다면 주기마다 수집된 값이 해당 조건을 만족하는 즉시 이벤트가 발생한 것으로 처리합니다.

**알림 그룹 리스트**에는 System Monitoring에 생성된 알림 그룹을 선택할 수 있습니다. 이벤트가 발생하면 그룹에 지정된 발송 채널을 통해 그룹 내 사용자들에게 이벤트 발생 내역을 통지하게 됩니다. (단, 알림 그룹에서 참고하는 대상은 **알림 유형**과 **사용자 그룹** 항목이며 감시 설정이나 서버 목록은 OpenMetrics 모니터링과는 무관합니다.)

알림 설정에 필요한 각 항목들을 입력한 후 **등록** 버튼을 클릭하면 입력했던 알림 이름이 목록에 추가된 것을 확인할 수 있습니다.

지표 선택과 알림 설정이 완료되면 차트 추가 창 하단의 **저장** 버튼을 클릭하여 차트를 생성할 수 있습니다.

### 차트 수정
각 차트의 우측 상단에 있는 톱니바퀴 모양의 아이콘을 클릭하면 차트를 수정할 수 있습니다. 차트 생성 시 사용되었던 것과 같은 모양의 팝업창이 표시됩니다.
변경이 필요한 부분에 대해서 수정을 한 후, 하단의 **수정** 버튼을 클릭하면 변경사항이 반영되어 저장됩니다.

### 차트 삭제
각 차트의 우측 상단에 있는 X 모양의 아이콘을 클릭하면 차트를 삭제할 수 있습니다. 차트 삭제 시 해당 차트에 활성화되어있던 알림 설정도 함께 삭제됩니다.